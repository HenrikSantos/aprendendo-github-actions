name: Jest test coverage
on: 
  push:
    branches: [ pull-request ]

jobs:
  Jest:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: latest
      - run: npm ci
      - name: Verificar Cobertura
        run: |
          const coverage = require('./coverage/lcov-report/index.json');
          const totalCoverage = coverage.total;

          if (totalCoverage.lines.pct !== 100 || totalCoverage.statements.pct !== 100) {
            echo "A cobertura de testes não é de 100%.";
            exit 1;
          }